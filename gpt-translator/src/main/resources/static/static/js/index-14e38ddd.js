import{p as A,f as G,d as H,a as J}from"./query-f6141626.js";import{d as K,a as _,z as O,r as I,o as Q,b as n,c as W,e as f,f as e,w as o,g as X,h,p as Y,i as Z,_ as ee}from"./index-21f4f83c.js";import{m as w}from"./message-9c0c215e.js";const N=g=>(Y("data-v-6b415d02"),g=g(),Z(),g),te={class:"form"},ae=N(()=>f("h4",{class:"table-name"},"项目查询:",-1)),oe={style:{padding:"10px 30px 10px 30px"}},le=N(()=>f("h3",null,"文件列表:",-1)),ne={class:"pagination"},re=K({name:"project",__name:"index",setup(g){const p=_(1),i=_(10),S=_(!1),k=_(!1),P=_(!1),V=O(),v=I({data:[],total:0}),r=I({projectName:""}),u=(a,t,s)=>A({pageNum:a,pageSize:t,...s}).then(m=>{v.data=m.data.records,v.total=m.data.total}),x=_(new Map),D=async(a,t)=>{t.length>0&&await G({projectId:a.projectId}).then(s=>{s.code===0&&x.value.set(a.projectId,s.data)})},F=()=>{u(p.value,i.value,r)},B=a=>{u(p.value,a,r)},U=a=>{u(a,i.value,r)},$=(a,t)=>{V.push({name:"translate",query:{projectId:a,fileId:t}})},C=(a,t)=>{const s=a+t;return s===0?0:(t/s*100).toFixed(2)},q=a=>{H({id:a}).then(t=>{t.code===0?(w("删除项目成功",{type:"success"}),u(p.value,i.value,r)):w(t.msg,{type:"error"})})},E=a=>{J({id:a}).then(t=>{t.code===0?(w("删除文件成功",{type:"success"}),u(p.value,i.value,r)):w(t.msg,{type:"error"})})};return Q(()=>{u(p.value,i.value,r)}),(a,t)=>{const s=n("el-input"),m=n("el-form-item"),b=n("el-button"),M=n("el-form"),d=n("el-table-column"),j=n("el-popconfirm"),y=n("el-progress"),z=n("el-table"),R=n("el-pagination"),T=n("el-card");return X(),W("div",null,[f("div",te,[e(M,{ref:"formRef",inline:!0,model:r,class:"bg-bg_color w-[99/100] pl-8 pt-4"},{default:o(()=>[e(m,{label:"项目名称：",prop:"projectName"},{default:o(()=>[e(s,{modelValue:r.projectName,"onUpdate:modelValue":t[0]||(t[0]=l=>r.projectName=l),placeholder:"输入查询项目名称",clearable:"",class:"!w-[200px]"},null,8,["modelValue"])]),_:1}),e(m,null,{default:o(()=>[e(b,{type:"primary",onClick:F},{default:o(()=>[h(" 搜索 ")]),_:1})]),_:1})]),_:1},8,["model"])]),e(T,null,{default:o(()=>[ae,e(z,{data:v.data,style:{width:"100%"},border:"",onExpandChange:D},{default:o(()=>[e(d,{type:"expand"},{default:o(l=>[f("div",oe,[le,e(z,{data:x.value.get(l.row.projectId),border:!1},{default:o(()=>[e(d,{label:"文件名",prop:"fileName"}),e(d,{label:"操作",width:"200px"},{default:o(c=>[e(b,{size:"small",onClick:L=>$(c.row.projectId,c.row.fileId)},{default:o(()=>[h(" 查看翻译 ")]),_:2},1032,["onClick"]),e(j,{onConfirm:L=>E(c.row.fileId),title:"是否删除 "+c.row.fileName+"?"},{reference:o(()=>[e(b,{size:"small",type:"danger"},{default:o(()=>[h("删除")]),_:1})]),_:2},1032,["onConfirm","title"])]),_:1}),e(d,{width:"200",label:"翻译进度"},{default:o(c=>[e(y,{percentage:C(c.row.notCompleted,c.row.completed)},null,8,["percentage"])]),_:1})]),_:2},1032,["data"])])]),_:1}),e(d,{prop:"projectId",label:"id",width:"50px"}),e(d,{prop:"projectName",label:"项目名称"}),e(d,{label:"操作",width:"75px"},{default:o(l=>[e(j,{onConfirm:c=>q(l.row.projectId),title:"是否删除 "+l.row.projectName+"?"},{reference:o(()=>[e(b,{size:"small",type:"danger"},{default:o(()=>[h("删除")]),_:1})]),_:2},1032,["onConfirm","title"])]),_:1}),e(d,{width:"200",label:"翻译进度"},{default:o(l=>[e(y,{percentage:C(l.row.notCompleted,l.row.completed)},null,8,["percentage"])]),_:1})]),_:1},8,["data"]),f("div",ne,[e(R,{"current-page":p.value,"onUpdate:currentPage":t[1]||(t[1]=l=>p.value=l),"page-size":i.value,"onUpdate:pageSize":t[2]||(t[2]=l=>i.value=l),"page-sizes":[10,20,50,100],small:S.value,disabled:P.value,background:k.value,layout:"total, sizes, prev, pager, next, jumper",total:v.total,onSizeChange:B,onCurrentChange:U},null,8,["current-page","page-size","small","disabled","background","total"])])]),_:1})])}}});const pe=ee(re,[["__scopeId","data-v-6b415d02"]]);export{pe as default};
